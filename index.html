<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Trivia Time</title>
  <style>
    body {
      background: black;
      color: white;
      font-size: 24px;
      font-weight: normal;
      display: flex;
      align-items: center;
      justify-content: center;
      height: 100vh;
      margin: 0;
      text-align: center;
      flex-direction: column;
      transition: background 0.5s, color 0.5s;
    }
    .bold { font-size: 36px; font-weight: bold; }
    .option { display: block; margin: 10px 0; font-size: 24px; }
    .correct { font-weight: bold; color: black; }
    button { margin-top: 20px; font-size: 20px; padding: 10px 20px; cursor: pointer; }
  </style>
</head>
<body>
  <div id="category" class="bold">Turn your phone upright for trivia!</div>
  <div id="question"></div>
  <div id="options"></div>
  <button id="showAnswerBtn" style="display:none">Show Answer</button>

  <script>
    const questions = [
      {
        category: "TOYS & GAMES",
        question: "What board game involved buying property and charging rent with little plastic houses?",
        options: ["A. Life", "B. Clue", "C. Sorry!", "D. Monopoly"],
        answer: "D"
      },
      {
        category: "TOYS & GAMES",
        question: "What did people used to do with Pet Rocks in the mid-70s?",
        options: ["A. Feed them", "B. Train them", "C. Talk to them", "D. All of the above"],
        answer: "D"
      },
      {
        category: "TOYS & GAMES",
        question: "What toy let kids stretch its arms across the room?",
        options: ["A. G.I. Joe", "B. Stretch Armstrong", "C. The Hulk", "D. Gumby"],
        answer: "B"
      },
      {
        category: "TOYS & GAMES",
        question: "What doll ‘talked’ when you pulled a string on her back?",
        options: ["A. Chatty Cathy", "B. Barbie", "C. Baby Alive", "D. Cindy"],
        answer: "A"
      },
      {
        category: "TOYS & GAMES",
        question: "What spinning toy had a string and made a big comeback in the 1970s?",
        options: ["A. Slinky", "B. Paddleball", "C. Yo-Yo", "D. Jack-in-the-Box"],
        answer: "C"
      },
      {
        category: "TOYS & GAMES",
        question: "What game included colorful dots and a big plastic sheet you had to twist around on?",
        options: ["A. Twister", "B. Simon", "C. Hungry Hungry Hippos", "D. Trouble"],
        answer: "A"
      }
    ];

    let hasQuestion = false;
    let lastAnswerTime = 0;
    let showingAnswer = false;
    let currentQuestion = null;

    function pickQuestion() {
      const randomIndex = Math.floor(Math.random() * questions.length);
      return questions[randomIndex];
    }

    function displayQuestion(data) {
      currentQuestion = data;
      document.body.style.background = 'yellow';
      document.getElementById('category').style.color = 'black';
      document.getElementById('question').style.color = 'black';

      document.getElementById('category').textContent = data.category;
      document.getElementById('question').textContent = data.question;

      const optionsHTML = data.options.map(option => {
        const letter = option.charAt(0);
        return `<span class="option" data-letter="${letter}">${option}</span>`;
      }).join('');

      document.getElementById('options').innerHTML = optionsHTML;
      document.getElementById('options').style.color = 'black';
      document.getElementById('showAnswerBtn').style.display = 'inline-block';

      showingAnswer = false;
    }

    document.getElementById('showAnswerBtn').addEventListener('click', () => {
      const correctLetter = currentQuestion.answer;
      const options = Array.from(document.querySelectorAll('.option'));

      options.forEach(option => {
        const letter = option.getAttribute('data-letter');
        if (letter === correctLetter) {
          option.classList.add('correct');
        } else {
          option.remove();
        }
      });

      lastAnswerTime = Date.now();
      showingAnswer = true;
    });

    function applyHighlight(show) {
      const now = Date.now();
      const delayPassed = now - lastAnswerTime > 3000;

      if (show && !hasQuestion && (!showingAnswer || delayPassed)) {
        hasQuestion = true;
        const q = pickQuestion();
        displayQuestion(q);
      } else if (!show) {
        hasQuestion = false;
        document.body.style.background = 'black';
        document.getElementById('category').style.color = 'white';
        document.getElementById('category').textContent = 'Turn your phone upright for trivia!';
        document.getElementById('question').textContent = '';
        document.getElementById('options').innerHTML = '';
        document.getElementById('showAnswerBtn').style.display = 'none';
      }
    }

    function handleOrientation() {
      const o = screen.orientation?.type || window.orientation;
      const isPortrait = (typeof o === 'string' && o.includes('portrait')) ||
                         (typeof o === 'number' && (o === 0 || o === 180));
      applyHighlight(isPortrait);
    }

    function handleMotion(event) {
      const z = event.accelerationIncludingGravity?.z || 0;
      const isUpright = z > 7;
      applyHighlight(isUpright);
    }

    function initListeners() {
      if ('DeviceMotionEvent' in window) {
        if (typeof DeviceMotionEvent.requestPermission === 'function') {
          DeviceMotionEvent.requestPermission().then(response => {
            if (response === 'granted') {
              window.addEventListener('devicemotion', handleMotion);
            } else {
              fallbackToOrientation();
            }
          }).catch(fallbackToOrientation);
        } else {
          window.addEventListener('devicemotion', handleMotion);
        }
      } else {
        fallbackToOrientation();
      }
    }

    function fallbackToOrientation() {
      if ('screen' in window && 'orientation' in screen) {
        screen.orientation.addEventListener('change', handleOrientation);
        handleOrientation();
      } else if ('orientation' in window) {
        window.addEventListener('orientationchange', handleOrientation);
        handleOrientation();
      } else {
        alert('Orientation detection not supported.');
      }
    }

    initListeners();
  </script>
</body>
</html>
